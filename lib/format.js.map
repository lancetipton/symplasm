{"version":3,"sources":["format.js"],"names":["options","root","tagConvert","attrKeyConvert","attrValueConvert","attrKeyAdd","trim","lowerCaseTag","comments","selectorCheck","attrArrEmpty","domTagAction","convertBlock","block","nodes","children","data","runAction","action","node","key","value","Object","keys","reduce","attrs","useKey","length","map","child","buildBlock","org","added","assign","args","tagName","toLowerCase","Array","isArray","format","parent","childs","type","filterFS","formatNode","push","formatAttributes","attributes","parts","item","formatValue","addAttribute","updatedVal","def","updateVal","tagType","nodeAttrs","selector","all","selectKeys","setSelector","start","end","text","content","replace","formatFS","_options","rootFS"],"mappings":"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","file":"format.js","sourcesContent":["import {\n  addChildren,\n  convertStyle,\n  setupSelectors,\n  unquote\n} from './helpers'\n\nlet options = {\n  root: {\n    0: 'div',\n  },\n  tagConvert: {},\n  attrKeyConvert: {},\n  attrValueConvert: {},\n  attrKeyAdd: {},\n  trim: false,\n  lowerCaseTag: true,\n  comments: true\n}\n\nlet selectorCheck = {\n  tagConvert: {},\n  attrKeyConvert: {},\n  attrValueConvert: {},\n  attrKeyAdd: {},\n}\nlet attrArrEmpty = true\nconst domTagAction = '$$DOM_TAG_NAME'\n\nconst convertBlock = (block, nodes, children) => {\n  const data = selectorCheck.tagConvert[block[0]]\n    ? runAction({\n        action: selectorCheck.tagConvert[block[0]],\n        node: block,\n        key: domTagAction,\n        value: block[0],\n        nodes,\n        children\n      }, 'value')\n    : block[0]\n  if(typeof data === 'string') block[0] = data\n  if(typeof data === 'object') block = data\n\n  block[1] = typeof block[1] === 'object'\n    ? Object.keys(block[1]).reduce((attrs, key) => {\n        let useKey = selectorCheck.attrKeyConvert[key]\n          ? runAction({\n              action: selectorCheck.attrKeyConvert[key],\n              node: block,\n              value: block[1][key],\n              key,\n              nodes,\n              children\n            }, 'key')\n          : key\n\n        if(useKey && block[1][key]){\n          attrs[useKey] = selectorCheck.attrValueConvert[key]\n            ? runAction({\n                action: selectorCheck.attrValueConvert[key],\n                node: block,\n                value: block[1][key],\n                key,\n                nodes,\n                children\n              }, 'value')\n            : typeof block[1][key] === 'string'\n              ? unquote(block[1][key])\n              : block[1][key]\n        }\n\n        return attrs\n      }, {})\n    : {}\n\n  if(block[2] &&  typeof block[2] !== 'string' && block[2].length){\n    block[2] = block[2].map(child => {\n      return convertBlock(child, nodes, children)\n    })\n  }\n\n  return block\n}\n\nconst buildBlock = (org, added, nodes, children) => {\n  org[0] = added[0]\n  org[1] = Object.assign({}, org[1], added[1])\n  if(added[2]) org[2] = added[2]\n  return convertBlock(org, nodes, children)\n}\n\nconst tagConvert = (args) => {\n  const { action, node, value, nodes, children } = args\n  let { block } = args\n\n  const tagName = node[0]\n  if(!tagName) return block\n  block[0] = options.lowerCaseTag\n    ? tagName.toLowerCase()\n    : tagName\n\n  if(typeof action === 'function'){\n    let data = runAction({\n      key: domTagAction,\n      value: block[0],\n      action,\n      node,\n      nodes,\n      children\n    }, 'value')\n    if(!data) return block\n    if(typeof data === 'string') data = { 0: data }\n    \n    if(typeof data === 'object')\n      block = buildBlock(block, data, nodes, children)\n  }\n  else if(typeof action === 'object' && !Array.isArray(action) && action[0]){\n    block = buildBlock(block, action, nodes, children)\n  }\n  else {\n    const data = runAction({\n      key: domTagAction,\n      value: block[0],\n      action,\n      node,\n      nodes,\n      children\n    }, 'value')\n    if(typeof data === 'string') block[0] = data\n    if(typeof data === 'object'){\n      block = buildBlock(block, data, nodes, children)\n    }\n  }\n  return block\n}\n\n// ----------- Formatters ----------- //\nconst format = (args) => {\n  const { parent, children } = args\n  let { childs, nodes, } = args\n\n  return childs\n    ? childs.reduce((children, node) => {\n        nodes = nodes || childs\n        const child = node.type === 'text' || node.type === 'comment'\n          ? filterFS(node, parent)\n          : formatNode(node, childs, nodes, children)\n        child && children.push(child)\n        return children\n      }, [])\n    : []\n}\n\nconst formatNode = (node, nodes, children) => {\n  const block = selectorCheck.tagConvert[node[0]]\n    ? tagConvert({\n        action: selectorCheck.tagConvert[node[0]],\n        block: {},\n        value: node[0],\n        node,\n        nodes,\n        children\n      })\n    : { 0: node[0] }\n\n  // Build any of the current attrs\n  const attrs = formatAttributes({\n    attributes: node[1],\n    node,\n    nodes,\n    children\n  })\n\n  // current attr data get merge after the data from the node\n  // This is because the only way the block will have attrs is if it was tagConverted\n  block[1] = Object.assign({}, attrs, block[1])\n\n  const childs = format({\n    childs: node[2],\n    parent: block,\n    nodes,\n    children\n  })\n  return addChildren(block, childs)\n}\n\nconst formatAttributes = (args) => {\n  const { node, nodes, children } = args\n  let { attributes } = args\n  attributes = attributes || {}\n  const attrs = {}\n\n  Object.keys(attributes).map(item => {\n    const parts = [ item, attributes[item]]\n\n    const key = selectorCheck.attrKeyConvert[parts[0]]\n      ? runAction({\n          action: selectorCheck.attrKeyConvert[parts[0]],\n          key: parts[0],\n          value: parts[1],\n          node,\n          nodes,\n          children\n        }, 'key')\n      : parts[0]\n\n    const value = typeof parts[1] === 'string' || typeof parts[1] === 'object'\n      ? formatValue({\n          key: parts[0],\n          value: parts[1],\n          node,\n          nodes,\n          children\n        })\n      : null\n\n    if(key){\n      if(key === 'class' && value === '') attrs[key] = ''\n      if(key === 'id' && !value) return\n      attrs[key] = value || value === false\n        ? value\n        : true\n    }\n\n  })\n  \n  if(attrArrEmpty) return attrs\n  \n  return addAttribute({\n    node,\n    attrs,\n    nodes,\n    children\n  })\n  \n}\n\nconst formatValue = (args) => {\n  const { node, key, value, nodes, children } = args\n  const updatedVal = key === 'style' && typeof value === 'string'\n    ? convertStyle(unquote(value))\n    : selectorCheck.attrValueConvert[key]\n      ? runAction({\n          action: selectorCheck.attrValueConvert[key],\n          value: unquote(value),\n          node,\n          key,\n          nodes,\n          children\n        }, 'value')\n      : typeof value === 'string' && unquote(value) || value\n\n  if(updatedVal === 'true') return true\n  if(updatedVal === 'false') return false\n  return updatedVal\n}\n\n// ----------- Run options methods ----------- //\nconst runAction = (args, def) => {\n  const { action, node, key, value, nodes, children } = args\n  \n  switch(typeof action){\n    case 'string':\n      return action || args[def]\n    case 'function':\n      return action({\n        0: node[0],\n        1: node[1],\n        2: node[2]\n      }, key, value, nodes, children, options) || args[def]\n      \n    case 'object':\n      let updateVal\n      // Get the tag type to be checked\n      const tagType = node[0]\n       if(!tagType) return args[def]\n      \n      // Get the node attrs if there are any\n      const nodeAttrs = node[1]\n      if(!nodeAttrs) return args[def]\n      \n      // Get the selector to check\n      const selector = action[tagType]\n      // if none, return the default\n      if(!selector) return args[def]\n      // Check if it's an all selector, if it is, set the value\n      updateVal = selector.all || null\n      const selectKeys = Object.keys(selector)\n\n      if(\n        // Check if there are more keys then just the all key\n        selector.all && selectKeys.length > 1 ||\n        // Check if there is no all key, but there are other keys\n        !selector.all  && selectKeys.length >= 1\n      ){\n        // return the default if it's not a select all and no attrs exist\n        if(!nodeAttrs) return args[def]\n        // Loop the slector and check if any of the elements attrs match\n        let setSelector\n        \n        Object.keys(selector).map(key => {\n          // If the updateVaule is already set or the key does not exist, stop checking\n          if(setSelector || (!nodeAttrs[key] && nodeAttrs[key] !== '')) return\n          \n          if(nodeAttrs[key] === \"true\" && !selector[key][nodeAttrs[key]] && selector[key]['']){\n            updateVal = selector[key]['']\n            setSelector = true\n          }\n          else if(selector[key][nodeAttrs[key]]){\n            updateVal = selector[key][nodeAttrs[key]]\n            setSelector = true\n          }\n        })\n      }\n\n      if(updateVal){\n        // If we should update, set the update based on type\n        if(typeof updateVal === 'string' || typeof updateVal === 'object') return updateVal\n        else if(typeof updateVal === 'function'){\n          return updateVal({\n            0: node[0],\n            1: node[1],\n            2: node[2]\n          }, key, value, nodes, children, options) || args[def]\n        }\n      }\n      // If we should not update the elment, return the default\n      return args[def]\n\n    default:\n      return action || args[def]\n  }\n}\n\n// ----------- Helpers ----------- //\nconst addAttribute = (args) => {\n  const { node, attrs, nodes, children } = args\n  \n  Object.keys(selectorCheck.attrKeyAdd).map(key => {\n    const value = runAction({\n      action: selectorCheck.attrKeyAdd[key],\n      key,\n      node,\n      nodes,\n      children\n    })\n\n    if(value) attrs[key] = value\n  })\n\n  return attrs\n}\n\n\nconst filterFS = (node) => {\n  let start = ''\n  let end = ''\n  let text = node.content\n\n  if (node.type === 'comment') {\n    if(!options.comments) return null\n    start = '<!--'\n    end = '-->'\n  }\n  if (options.trim) {\n    return node.content.trim() !== '\\n' && node.content.replace(/\\s/g, '').length > 0\n      ? start + node.content.trim() + end\n      : null\n  }\n  return text\n    ? start + text + end\n    : null\n}\n\nexport const formatFS = (nodes, _options) => {\n  let rootFS = Object.assign({}, options.root, _options.root)\n  Object.assign(options, _options)\n  selectorCheck = setupSelectors(selectorCheck, options)\n  attrArrEmpty = Object.keys(options.attrKeyAdd).length === 0\n  \n  if(selectorCheck.tagConvert[rootFS[0]]){\n    rootFS = tagConvert({\n      action: selectorCheck.tagConvert[rootFS[0]],\n      block: rootFS,\n      value: rootFS[0],\n      node: rootFS,\n      children: nodes,\n      nodes,\n    })\n  }\n  rootFS[1] = formatAttributes({\n    attributes: rootFS[1],\n    node: rootFS,\n    children: nodes,\n    nodes\n  })\n\n  rootFS[2] = Array.isArray(rootFS[2])\n  ? rootFS[2].map(child => {\n      return convertBlock(child, nodes, nodes)\n    })\n  : []\n\n  return addChildren(rootFS, format({\n    childs: nodes,\n    parent: rootFS,\n  }))\n}"]}